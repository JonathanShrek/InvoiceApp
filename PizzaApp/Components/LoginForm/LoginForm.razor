@inject HttpClient Http
@inject AuthenticationStateProvider AuthStateProvider
@inject ILocalStorageService LocalStorage

@namespace PizzaApp.Components

<MudGrid>
    @if (IsLoading)
    {
        <MudItem xs="12" Class="pa-10 d-flex align-self-center justify-center">
            <MudProgressCircular Color="Color.Success" Indeterminate="true" />
        </MudItem>
    }
    else
    {
        <MudItem xs="12">
            <EditForm OnValidSubmit="Login" Model="Model" >
                <DataAnnotationsValidator />

                <MudGrid>
                    <MudItem xs="12" Class="d-flex align-self-center justify-md-start justify-center">
                        <h1>Login</h1>
                    </MudItem>
                </MudGrid>

                <MudGrid>
                    <MudItem xs="12">
                        <MudTextField Label="Username" @bind-Value="Model.Username" For="@(() => Model.Username)" InputMode="InputMode.text" InputType="InputType.Text" />
                    </MudItem>
                </MudGrid>

                <MudGrid>
                    <MudItem xs="12">
                        <MudTextField @bind-Value="Model.Password"
                            For="@(() => Model.Password)"
                            Label="Password"
                            Variant="Variant.Text"
                            InputType="@PasswordInput"
                            Adornment="Adornment.End"
                            AdornmentIcon="@PasswordInputIcon"
                            OnAdornmentClick="TogglePasswordVisibility"
                            AdornmentAriaLabel="Show Password" />
                    </MudItem>
                </MudGrid>

                <MudGrid>
                    @{
                        if (LoginError)
                        {
                            <MudItem xs="8" Class="d-flex justify-md-start align-self-center justify-center">
                                <MudText Class="justify-md-start align-self-center" Style="color: red">Wrong username or password entered.</MudText>
                            </MudItem>
                            <MudItem xs="4" Class="d-flex justify-md-end justify-center">
                                <MudButton Disabled="@BtnLogin" ButtonType="ButtonType.Submit" Variant="Variant.Filled" Color="Color.Primary" Class="my-3 flex-md-grow-0 flex-grow-1" >
                                    @if (BtnLogin)
                                    {
                                        <MudProgressCircular Class="ms-n1" Size="Size.Small" Indeterminate="true" />
                                        <MudText Class="ms-2">Processing</MudText>
                                    }
                                    else
                                    {
                                        <MudText>Login</MudText>
                                    }
                                </MudButton>
                            </MudItem>
                        }
                        else
                        {
                            <MudItem xs="12" Class="d-flex justify-md-end justify-center">
                                <MudButton Disabled="@BtnLogin" ButtonType="ButtonType.Submit" Variant="Variant.Filled" Color="Color.Primary" Class="my-3 flex-md-grow-0 flex-grow-1" >
                                    @if (BtnLogin)
                                    {
                                        <MudProgressCircular Class="ms-n1" Size="Size.Small" Indeterminate="true" />
                                        <MudText Class="ms-2">Processing</MudText>
                                    }
                                    else
                                    {
                                        <MudText>Login</MudText>
                                    }
                                </MudButton>
                            </MudItem>
                        }
                    }
                </MudGrid>
            </EditForm>
        </MudItem>
    }
</MudGrid>

@code {
}